<!DOCTYPE html>
<!--
 * Copyright (c) 2011 Marc Matteo All rights reserved.
 * Use of this source code is governed by a BSD-style license that can be
 * found in the LICENSE file.
-->
<html lang="en">
	<head>
		<title>Hiya</title>
		<meta charset="utf-8" />

		<style>
			body {
				width: 500px;
				font-family: Helvetica, Arial;
				font-size: 10pt;
			}

			.header {
				font-size: 20pt;
				margin-bottom: 10px;
			}

			.section {
				margin-bottom: 15px;
			}

			.section .title {
				font-size: 11pt;
				margin-bottom: 4px;
			}

			.box {
				background: #fafafa;
				border: 1px solid #ccc;
				border-radius: 5px;
				box-shadow: 3px 3px 3px #ccc;
				line-height: 150%;
				margin: 0 20px;
				padding: 5px;
			}

			.fieldName {
				font-weight: bold;
			}

			.tag {
				background: #eee;
				border: 1px solid #ddd;
				border-radius: 5px;
				font-size: 8pt;
				margin-right: 4px;
				padding: 0 4px;
			}

			#beaconData {
				background: white;
				border: 1px solid #eee;
				border-radius: 5px;
				display: none;
				font-size: 9pt;
				line-height: 130%;
				margin: 5px 20px 5px 10px;
				padding: 5px;
			}

			#beaconData .fieldValue {
				position: absolute;
				left: 200px;
			}
		</style>

		<script>
			function main() {
				chrome.tabs.getSelected(null, function(tab) {
					var microformatData = chrome.extension.getBackgroundPage().hNewsData[tab.id];

					document.getElementById('title').innerHTML = microformatData.hNews.title || '';
					document.getElementById('author').innerHTML = microformatData.hNews.author || '';
					document.getElementById('source').innerHTML = microformatData.hNews.source || '';
					document.getElementById('updated').innerHTML = (microformatData.hNews.updated) ? new Date(microformatData.hNews.updated) : '';

					document.getElementById('dateline').innerHTML = microformatData.hNews.dateline || '';
					document.getElementById('geo').innerHTML = (microformatData.hNews.geo) ? microformatData.hNews.geo.latitude + ", " + microformatData.hNews.geo.longitude : '';
					document.getElementById('license').innerHTML = (microformatData.hNews.license) ? microformatData.hNews.license.link : '';
					document.getElementById('principles').innerHTML = (microformatData.hNews.principle) ? microformatData.hNews.principle.link : '';
					document.getElementById('published').innerHTML = (microformatData.hNews.published) ? new Date(microformatData.hNews.published) : '';

					for (var x = 0; x < microformatData.hNews.tags.length; x++) {
						var tagSpan = document.createElement('span');
						tagSpan.setAttribute('class', 'tag');
						tagSpan.innerHTML = microformatData.hNews.tags[x];

						document.getElementById('tags').appendChild(tagSpan);
					}

					document.getElementById('licenseAP').innerHTML = (microformatData.hNews.license) ? 'Yes (see above)' : 'No';
					if (microformatData.apBeacon) {
						document.getElementById('beacon').innerHTML = (microformatData.apBeacon.isValid) ? 'Yes' : 'Invalid';
						document.getElementById('beaconData').style.display = 'block';

						document.getElementById('apCreatorId').innerHTML = microformatData.apBeacon.creatorId || '';
						document.getElementById('apReleaseWebSite').innerHTML = microformatData.apBeacon.rws || '';
						document.getElementById('apCreatorArticleId').innerHTML = microformatData.apBeacon.cai  || '';
						document.getElementById('apMyArticleId').innerHTML = microformatData.apBeacon.mai || '';
						document.getElementById('apCreatorVersionId').innerHTML = microformatData.apBeacon.cvi || '';
						document.getElementById('apEnvironment').innerHTML = microformatData.apBeacon.e || '';
						document.getElementById('apPermissionCategory').innerHTML = microformatData.apBeacon.pc || '';
						document.getElementById('apArticleType').innerHTML = microformatData.apBeacon.at || '';
					} else {
						document.getElementById('beacon').innerHTML = 'No';
					}
				});
			}
		</script>
	</head>

	<body onload="javascript:main()">
		<div class="header">
			<img src="images/mf_logo.gif" alt=""/>
			hNews Reader
		</div>

		<div class="section">
			<div class="title">hNews required fields:</div>
			<div class="required box">
				<div><span class="fieldName">Headline:</span> <span id="title" class="fieldValue"></span></div>
				<div><span class="fieldName">Byline:</span> <span id="author" class="fieldValue"></span></div>
				<div><span class="fieldName">Source:</span> <span id="source" class="fieldValue"></span></div>
				<div><span class="fieldName">Updated:</span> <span id="updated" class="fieldValue"></span></div>
			</div>
		</div>

		<div class="section">
			<div class="title">hNews optional fields:</div>
			<div class="optional box">
				<div><span class="fieldName">Dateline:</span> <span id="dateline" class="fieldValue"></span></div>
				<div><span class="fieldName">Geo:</span> <span id="geo" class="fieldValue"></span></div>
				<div><span class="fieldName">License:</span> <span id="license" class="fieldValue"></span></div>
				<div><span class="fieldName">Principles:</span> <span id="principles" class="fieldValue"></span></div>
				<div><span class="fieldName">Published:</span> <span id="published" class="fieldValue"></span></div>
				<div><span class="fieldName">Tags:</span> <span id="tags" class="fieldValue"></span></div>
			</div>
		</div>

		<div class="section">
			<div class="title">AP News Registry:</div>
			<div class="APNR box">
				<div><span class="fieldName">License:</span> <span id="licenseAP" class="fieldValue"></span></div>
				<div><span class="fieldName">Usage Tag (beacon):</span> <span id="beacon" class="fieldValue"></span>
					<div id="beaconData">
						<div><span class="fieldName">Creator Id:</span> <span id="apCreatorId" class="fieldValue"></span></div>
						<div><span class="fieldName">Release Web Site:</span> <span id="apReleaseWebSite" class="fieldValue"></span></div>
						<div><span class="fieldName">Creator Article Id:</span> <span id="apCreatorArticleId" class="fieldValue"></span></div>
						<div><span class="fieldName">My Article Id:</span> <span id="apMyArticleId" class="fieldValue"></span></div>
						<div><span class="fieldName">Creator Version Id:</span> <span id="apCreatorVersionId" class="fieldValue"></span></div>
						<div><span class="fieldName">Environment:</span> <span id="apEnvironment" class="fieldValue"></span></div>
						<div><span class="fieldName">Permission Category:</span> <span id="apPermissionCategory" class="fieldValue"></span></div>
						<div><span class="fieldName">Article Type:</span> <span id="apArticleType" class="fieldValue"></span></div>
					</div>
				</div>
			</div>
		</div>
	</body>
</html>
